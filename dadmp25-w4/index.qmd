---
title: "Probability and Visualization"
subtitle: "OIS Chapter 3, Jaynes, Grammar of Graphics"  
author: "Robert W. Walker"
date: '`r Sys.Date()`'
format: 
   revealjs:
     theme: [custom.scss]
     scrollable: true
     logo: AGSMlogo.jpeg
     footer: "DADM-Fall 2025"
     self-contained: true
     html-math-method: katex
     incremental: true
     slide-number: c/t
     transition: zoom
     multiplex: true
     preview-links: true
     code-fold: true
highlight-style: espresso
---

```{r setup, include=FALSE}
library(tidyverse) 
library(dplyr)
knitr::opts_chunk$set(fig.retina=3, fig.height=6, fig.width=9, echo=TRUE, eval=TRUE)
```

## The Dot Plot [it's really a beeswarm]

![from el-erian on X](img/TheDotPlot.jpeg)

[the link](https://x.com/elerianm/status/1968398113170932130?s=51)

# Overview

- AMA
- Introducing `esquisse`
- Basic Data Visualization: [The FAQ](https://robertwwalker.github.io/DADM-FAQ/)
- [The Economist: Mistakes](https://medium.economist.com/mistakes-weve-drawn-a-few-8cdd8a42d368)
- Tables
- Probability

# AMA

# Data

```{r}
load(url("https://github.com/robertwwalker/DADMStuff/raw/master/Week3Data.RData"))
```

## Introducing Esquisse

![Esquisse](img/esquisse.png)

## Executing

`esquisse:::esquisser(viewer="browser")`

**NB: It needs to run in a separate browser window.**

## Selecting Data

What is available in the environment?

[A Run Through](./esquisse.html)

## Basic Data Visualization

Particularly for qualitative variables, radiant is quite limited.

- [One Qualitative Variable](https://robertwwalker.github.io/DADM-FAQ/posts/visualizing-one-qualitative-variable/)   
- [One Quantitative Variable](https://robertwwalker.github.io/DADM-FAQ/posts/visualizing-one-quantitative-variable/)
- [Two Qualitative Variables](https://robertwwalker.github.io/DADM-FAQ/posts/visualizing-two-qualities/)   
- [Two Quantitative Variables](https://robertwwalker.github.io/DADM-FAQ/posts/visualizing-two-quantities/)
- [Visualizing a Mix](https://robertwwalker.github.io/DADM-FAQ/posts/visualizing-mixed-data/)

## One Qualitative Variable

Just filling has no x or y so a bar is the choice.

![Image](img/XBar.png)

## One Quantity

### Options

![Image](img/XOptions.png)

### BoxPlot

![Image](img/XBoxP.png)

### Density

![Image](img/XDens.png)

## Two Qualitative Variables

### Fill

![Image](img/FillAes.png)

### Stack

![Image](img/FillStack.png)

### Dodge

![Image](img/FillDodge.png)

## Two Quantities are Scatterplots

![Image](img/XYScat.png)

## Mixed Opens Up A Lot

![Selector](img/XYSelect.png)

### A Violin

**A note on scaling....**

![Scaling](img/XYViolS.png)

![Violin](img/XYViol.png)

## An Export

![Export JPEG](img/export-plot.jpeg)

## Two Geometries

![Double](img/DoubleX.png)

# Do's and Dont's

[The Economist: Mistakes](https://medium.economist.com/mistakes-weve-drawn-a-few-8cdd8a42d368)

# Probability and Tables

## Probability

```{r, echo=FALSE}
library(png); library(kableExtra)
Prob.Def <- readPNG("img/ETJ-Probability.png")
grid::grid.raster(Prob.Def)
```

# Probability

Two rules:   

1. Probabilities sum to one.
2. The probability of any event is greater than or equal to zero.

## Why Jaynes?

His approach is intuitive.  If you are familiar with probability already, some of you have formal training, Appendix A sets out the key differences.

Why did I ask you to read this?  He builds a basic foundation.  He derives rules.  Those rules are the same rules that we will deploy.  But he does it from more basic foundations.  Yes, he can do math. That's not the point; there is a simple representation of all of these ideas.  And only a small number of rules that we will define precisely.


## Where does Probability Come From?

There are three common sources of probabilities:

- Known formula [Dice, Coins, etc.]
- Empirical frequency
- Subjective belief

**Jaynes is a proponent of the latter.**

## A priori probability

The probability of a given integer on a k-sided die: $\frac{1}{k}$.

The probability of **heads** with a fair coin: $\frac{1}{2}$.

The probability of a Queen?  $\frac{4}{52}$

The probability of a Diamond?  $\frac{13}{52}$

The Queen of Diamonds? $\frac{1}{52}$ or   $(\frac{4}{52}\times\frac{13}{52})$

**Quasirandom numbers**

## Empirical probability: frequency

How often does something happen?

<iframe width="560" height="315" src="https://www.youtube.com/embed/tgC-vZp07YM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

[Annie](https://youtu.be/tgC-vZp07YM)

[Straight to Watch](https://www.youtube.com/watch?v=tgC-vZp07YM)

## This is Historical Statistics

How likely am I to be admitted? *Consult the admissions rate*

How fast do I drive? *Likelihood of law enforcement and need for speed*

In data: this is tables.

## Berkeley

::::{.columns}

::: {.column width="50%"}

```{r MD1, echo=FALSE}
library(tidyverse)
library(janitor)
table(UCBAdmit$M.F,UCBAdmit$Admit)
UCBAdmit %>% tabyl(M.F, Admit)
```

:::

::: {.column width="50%"}

```{r MD2, eval=FALSE}
library(tidyverse)
library(janitor)
table(UCBAdmit$M.F,UCBAdmit$Admit)
UCBAdmit %>% tabyl(M.F, Admit)
```

:::

::::

## Three Versions

::::{.columns}

::: {.column width="50%"}

```{r MD1B}
prop.table(table(UCBAdmit$M.F,UCBAdmit$Admit), 1)
prop.table(table(UCBAdmit$M.F,UCBAdmit$Admit), 2)
prop.table(table(UCBAdmit$M.F,UCBAdmit$Admit))
```

:::


::: {.column width="50%"}

```{r MD2B}
UCBAdmit %>% tabyl(M.F, Admit) %>% adorn_percentages("row")
UCBAdmit %>% tabyl(M.F, Admit) %>% adorn_percentages("col")
UCBAdmit %>% tabyl(M.F, Admit) %>% adorn_percentages("all")
```

:::

::::

## Plot It

```{r}
( UCBM <- ggplot(UCBAdmit) + aes(x=M.F, fill=Admit) + geom_bar(position="dodge") + scale_fill_viridis_d() )
```

More on this later.


## Subjective Probability

How likely **do we believe** something is?


## The Great Divide

Empirical frequency vs. subjective belief

# Empirical Frequency: She's Right  

## Physics Disagrees: We Goin Nova.....


## Annie's a liar.

What matters in group decision making is probably as much the beliefs [subjective] as the evidence [frequency].

How should we reflect this in strategies of argumentation/persuasion?

## Think

What matters?

```{r, eval=TRUE}
# RUN ME
# may need to install.packages("countdown")
library(countdown)
countdown_fullscreen(
  minutes = 5, seconds = 0,
  margin = "5%",
  font_size = "8em",
)
```

## Three Concepts from Set Theory

- Intersection [and]
- Union [or] **avoid double counting the intersection**
- Complement [not]

## Three Distinct Probabilities

- Joint: Pr(x=x and y=y)
- Marginal: Pr(x=x) or Pr(y=y)
- Conditional: Pr(x=x | y=y) or Pr(y =y | x = x)

## Joint Probability

**The table sums to one**.  

For Berkeley:

```{r}
UCBAdmit %>% tabyl(M.F, Admit) %>% adorn_percentages("all")
prop.table(table(UCBAdmit$M.F,UCBAdmit$Admit))
```

## Marginal Probability

**The row/column sums to one**.  We collapse the table to a single margin.  Here, two can be identified.  The probability of Admit and the probability of M.F.  

::::{.columns}

::: {.column width="50%"}

```{r}
UCBAdmit %>% tabyl(M.F)
UCBAdmit %>% tabyl(Admit)
```

:::


::: {.column width="50%"}

```{r}
prop.table(table(UCBAdmit$M.F))
prop.table(table(UCBAdmit$Admit))
```
:::

::::

## Conditional Probability

How does one margin of the table break down given values of another?  **Each row or column sums to one**  

Four can be identified, the probability of admission/rejection for Male, for Female; the probability of male or female for admits/rejects.

For Berkeley:

::::{.columns}

::: {.column width="50%"}

```{r}
UCBAdmit %>% tabyl(M.F, Admit) %>% adorn_percentages("row")
prop.table(table(UCBAdmit$M.F,UCBAdmit$Admit), 1)
```

:::


::: {.column width="50%"}

```{r}
UCBAdmit %>% tabyl(M.F, Admit) %>% adorn_percentages("col")
prop.table(table(UCBAdmit$M.F,UCBAdmit$Admit), 2)
```

:::

::::

## Law of Total Probability

Is a combination of the distributive property of multiplication and the fact that probabilities sum to one.

For example, the probability of Admitted and Male is the probability of admission for males times the probability of male.

$$ Pr(x=x, y=y) = Pr(y | x)Pr(x) $$

Or it is the probability of being admitted times the probabilty of being male among admits.

$$ Pr(x=x, y=y) = Pr(x | y)Pr(y) $$


## Now the Substance

::::{.columns}

::: {.column width="50%"}
The `ggplot` fill aesthetic is great for displaying these things.   For example, are males and females equally likely to be admitted to Berkeley?

**Plaintiffs say no.**

```{r, echo=TRUE, eval=FALSE}
ggplot(UCBAdmit) + aes(x=M.F, fill=Admit) + geom_bar() + scale_fill_viridis_d()
```
:::

::: {.column width="50%"}
```{r, echo=FALSE}
ggplot(UCBAdmit) + aes(x=M.F, fill=Admit) + geom_bar() + scale_fill_viridis_d()
```
:::

::::

## Is that an Adequate Comparison?

::::{.columns}

::: {.column width="50%"}

The University says no.  Why?  The most important factor in the probability of admission is likely to be the department.  This has a huge impact on what we see.


```{r, eval=FALSE}
ggplot(UCBAdmit) + 
  aes(x=M.F, fill=Admit) + 
  geom_bar(position="fill") + 
  scale_fill_viridis_d() + 
  facet_wrap(vars(Dept))
```
:::

::: {.column width="50%"}
```{r, eval=TRUE, echo=FALSE}
ggplot(UCBAdmit) + aes(x=M.F, fill=Admit) + geom_bar(position="fill") + scale_fill_viridis_d() + facet_wrap(vars(Dept))
```

:::

::::


## The Magic of Bayes Rule

To find the joint probability [the intersection] of x and y, we can use either of the aforementioned methods.  To turn this into a conditional probability, we simply take it is a proportion of the relevant margin.

$$ Pr(x | y) = \frac{Pr(y | x) Pr(x)}{Pr(y)} $$

## A Bit on Juries

- Start from Section 3.2.7
- The juror's decision tree

![Tree](img/JTree2.png)

Three nodes: guilty and not at each, convict at the third.

## Bayesian Reasoning is Core to Toulmin's Thinking {background-image="img/BayesRuleRWW.jpeg"}
[
$$ Pr(Decision | data) = \frac{Pr(data | Decision) Pr(Decision)}{Pr(Data)} $$
]{style="color:red;"}

# The Page on Global Strategic Trends